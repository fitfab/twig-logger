{"version":3,"sources":["index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAA,MAAA,GAAA,OAAA,CAAA,MAAA,CAAA;;AACA,IAAA,MAAA,GAAA,eAAA,CAAA,OAAA,CAAA,MAAA,CAAA,CAAA;;AACA,IAAA,QAAA,GAAA,eAAA,CAAA,OAAA,CAAA,QAAA,CAAA,CAAA;;AACA,IAAA,SAAA,GAAA,eAAA,CAAA,OAAA,CAAA,SAAA,CAAA,CAAA;;AACA,IAAA,aAAA,GAAA,eAAA,CAAA,OAAA,CAAA,aAAA,CAAA,CAAA;;AACA,IAAA,WAAA,GAAA,eAAA,CAAA,OAAA,CAAA,WAAA,CAAA,CAAA;;AACA,IAAA,aAAA,GAAA,eAAA,CAAA,OAAA,CAAA,aAAA,CAAA,CAAA;;AACA,IAAA,QAAA,GAAA,eAAA,CAAA,OAAA,CAAA,QAAA,CAAA,CAAA;;AACA,IAAA,QAAA,GAAA,eAAA,CAAA,OAAA,CAAA,QAAA,CAAA,CAAA,EAEA;;;AAEA,IAAM,YAAY,GAAG,IAAI,QAAA,CAAA,SAAA,CAAJ,EAArB,EAEA;;AACA,IAAM,UAAU,GAAG,MAAA,CAAA,SAAA,CAAA,CAAK,OAAL,CAAa,SAAb,EAAwB,SAAxB,CAAnB,EAEA;;AACA,IAAM,IAAI,GAAG,OAAO,CAAC,GAAR,CAAY,IAAZ,IAAoB,IAAjC,EAEA;;AACA,IAAM,GAAG,GAAG,SAAA,CAAA,SAAA,CAAA,EAAZ,EAEA;;AACA,IAAM,MAAM,GAAG,MAAA,CAAA,YAAA,CAAa,GAAb,CAAf,EAEA;;AACA,IAAM,EAAE,GAAG,IAAI,WAAA,CAAA,SAAA,CAAJ,CAAa,MAAb,CAAX,EAEA;;AACA,IAAM,GAAG,GAAG,GAAG,CAAC,GAAJ,CAAQ,KAAR,MAAmB,YAA/B,EAEA;;AACA,GAAG,CAAC,GAAJ,CAAQ,SAAA,CAAA,SAAA,CAAA,CAAQ,MAAR,CAAe,UAAf,CAAR,GAEA;;AACA,IAAI,CAAC,GAAL,EAAU;AACR;AACA;AACA,EAAA,GAAG,CAAC,GAAJ,CAAQ,QAAA,CAAA,SAAA,CAAA,EAAR,EAHQ,CAKR;;AACA,EAAA,GAAG,CAAC,GAAJ,CAAQ,aAAA,CAAA,SAAA,CAAA,EAAR,EANQ,CAQR;;AACA,EAAA,GAAG,CAAC,GAAJ,CAAQ,QAAA,CAAA,SAAA,CAAA,CAAO,QAAP,CAAR;AACD;;AAED,IAAI,GAAJ,EAAS;AACP;AACA,EAAA,GAAG,CAAC,GAAJ,CAAQ,QAAA,CAAA,SAAA,CAAA,CAAO,KAAP,CAAR;AACA,EAAA,OAAO,CAAC,GAAR,CAAY,kCAAZ;AAGD,EAED;;;AACA,GAAG,CAAC,GAAJ,CAAQ,aAAA,CAAA,SAAA,CAAA,CAAW,IAAX,EAAR,GAEA;;AACA,GAAG,CAAC,GAAJ,CAAQ,eAAR,EAAyB,UAAC,GAAD,EAAM,GAAN,EAAW,IAAX,EAAe;AACtC,EAAA,OAAO,CAAC,GAAR,CAAY,UAAZ,EAAwB,GAAG,CAAC,IAA5B;AACA,EAAA,YAAY,CAAC,IAAb,CAAkB,QAAlB,EAA4B,GAAG,CAAC,IAAhC;AACA,EAAA,GAAG,CAAC,IAAJ,CAAS,IAAI,CAAC,SAAL,CAAe,GAAG,CAAC,IAAnB,EAAyB,IAAzB,EAA+B,CAA/B,CAAT;AACD,CAJD,GAMA;AACA;AACA;;AACA,GAAG,CAAC,GAAJ,CAAQ,GAAR,EAAa,UAAC,GAAD,EAAM,GAAN,EAAW,IAAX,EAAe;AAC1B,EAAA,GAAG,CAAC,QAAJ,CAAgB,UAAU,GAAA,aAA1B;AACD,CAFD;AAIA,IAAI,SAAS,GAAG,CAAhB,EAEA;;AACA,EAAE,CAAC,EAAH,CAAM,YAAN,EAAoB,UAAS,MAAT,EAAe;AACjC,EAAA,SAAS;AACT,MAAI,KAAK,GAAG,CAAZ;AACA,EAAA,OAAO,CAAC,GAAR,CAAY,gBAAc,SAA1B;AAEA,EAAA,YAAY,CAAC,EAAb,CAAgB,QAAhB,EAA0B,UAAA,GAAA,EAAG;AAC3B,IAAA,OAAO,CAAC,GAAR,CAAY,YAAU,KAAtB;AACA,IAAA,KAAK;AACL,IAAA,EAAE,CAAC,IAAH,CAAQ,MAAR,EAAgB,GAAhB;AACD,GAJD;AAKD,CAVD;AAYA,MAAM,CAAC,MAAP,CAAc,IAAd,EAAoB,UAAA,GAAA,EAAG;AACrB,MAAI,GAAJ,EAAS,MAAM,GAAN;AACT,EAAA,OAAO,CAAC,GAAR,CAAY,qCACkB,IADlB,GACsB,QADlC;AAGD,CALD","file":"index.map","sourceRoot":"","sourcesContent":["import { createServer } from \"http\";\nimport path from \"path\";\nimport EventEmitter from \"events\";\nimport express from \"express\";\nimport bodyParser from \"body-parser\";\nimport SocketIO from \"socket.io\";\nimport compression from \"compression\";\nimport morgan from \"morgan\";\nimport helmet from \"helmet\";\n\n// Event Emitter\n\nconst eventEmitter = new EventEmitter();\n\n// Reference to the build(SPA) directory\nconst distFolder = path.resolve(__dirname, \"../dist\");\n\n// set the port number\nconst PORT = process.env.PORT || 5000;\n\n// 1) Create the web app application with Expressjs\nconst app = express();\n\n// 2) create the server\nconst server = createServer(app);\n\n// 3) create socket.io\nconst io = new SocketIO(server);\n\n// Check Express default env variable\nconst dev = app.get(\"env\") !== \"production\";\n\n// Point to the build for the static files\napp.use(express.static(distFolder));\n\n// Run Production setup\nif (!dev) {\n  // Helmet helps secure the Express apps by setting various HTTP headers.\n  // https://www.npmjs.com/package/helmet\n  app.use(helmet());\n\n  // Compression middleware for gzip\n  app.use(compression());\n\n  // Logging middleware with the common flag\n  app.use(morgan(\"common\"));\n}\n\nif (dev) {\n  // Logging middleware with the dev flag\n  app.use(morgan(\"dev\"));\n  console.log(`\n    [ Development Mode ]\n    `);\n}\n\n// parse application/json\napp.use(bodyParser.json());\n\n// handles logs\napp.use(\"/artnetlogger\", (req, res, next) => {\n  console.log(\"req.body\", req.body);\n  eventEmitter.emit(\"logger\", req.body);\n  res.send(JSON.stringify(req.body, null, 2));\n});\n\n// Route any request coming in\n// to be handle by the SPA. -- must use `*`\n// https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/template/README.md#serving-apps-with-client-side-routing\napp.use(\"*\", (req, res, next) => {\n  res.sendFile(`${distFolder}/index.html`);\n});\n\nlet connected = 0;\n\n// log connection\nio.on(\"connection\", function(socket) {\n  connected++;\n  let count = 0;\n  console.log(`Connected: ${connected}`);\n\n  eventEmitter.on(\"logger\", msg => {\n    console.log(`Count: ${count}`);\n    count++;\n    io.emit(\"perf\", msg);\n  });\n});\n\nserver.listen(PORT, err => {\n  if (err) throw err;\n  console.log(`\n    [ server started on port: ${PORT} ]\n  `);\n});\n"]}